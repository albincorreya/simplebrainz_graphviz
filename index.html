<!DOCTYPE html>
		<meta charset="utf-8">
		<!-- Optimized from http://biohackathon.org/d3sparql/d3sparql.html -->
		<html>
		<head>
		<!--<link rel="stylesheet" type="text/css" href="index.css">-->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<title>simplebrainz.org</title>
		</head>
		<script src="https://d3js.org/d3.v3.min.js"></script>
		<script src="./src/d3sparql.js"></script>
		<script src="./parser.js"></script>>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
		<script src="./test.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script>
		///*
			//d3.select("body").append("p").text("Get the links");
			var outputJSON; //global variable
			//var inputQuery = 
			//var inputMbid = 

			var config = {
	        "charge": -300,
	        "distance": 150,
	        "width": 1000,
	        "height": 750,
	        "selector": "#result"
	      };
			
		
			function onclickSearch(){
				var endpoint ="http://localhost:8890/sparql";
				//var query = "select ?s ?p ?o WHERE {{<http://simplebrainz.org/song/b153e1a6-a1ee-4666-9deb-93369348bd4e#_> ?p ?o} UNION {?s ?p <http://simplebrainz.org/song/b153e1a6-a1ee-4666-9deb-93369348bd4e#_>}}";
				//var endpoint = "https://dbpedia.org/sparql";
				var query = d3.select("#sparql").property("value");
				var format = "application/sparql-results+json";
				if(query.length<6){
					var query = "SELECT * WHERE{ ?s ?p ?o} LIMIT 50";
				}
				//var query = "PREFIX rank:<http://www.ontotext.com/owlim/RDFRank#> SELECT ?n WHERE {?n rank:hasRDFRank ?r } ORDER BY DESC(?r) LIMIT 100";
				/*
				var params = {"query": query, "format":format,"Access-Control-Allow-Origin": 'http://albincorreya.github.io/smb_browser'};

				var querypart="";
				for(var k in params) {
					querypart+=k+"="+encodeURIComponent(params[k])+"&";
				}*/
				var url = endpoint + "?query=" + encodeURIComponent(query);
				//var url = endpoint + '?' + querypart;
				//var format = "application/json";	
				d3.xhr(url, format, function(request) {
	    		outputJSON = JSON.parse(request.responseText);
					sampleGraph();
					//window.alert("Successful request!");
	  		})
			}
			
			function sampleGraph(){d3sparql.forcegraph(outputJSON,config);};

			/*
			function stdQuery(){
				var endpoint ="http://localhost:8890/sparql";
				var query = d3.select("#sparql").property("value");
				var format = "application/sparql-results+json";
				if(query.length<6){
					var query = "SELECT * WHERE{ ?s ?p ?o} LIMIT 50";
				}			
				var params = {"query": query, "format":format};
				var querypart="";
				for(var k in params) {
					querypart+=k+"="+encodeURIComponent(params[k])+"&";
	
				var url = endpoint + '?' + querypart;
			    var xmlhttp = new XMLHttpRequest();
			    xmlhttp.onreadystatechange = function() {
			        if (this.readyState == 4 && this.status == 200) {
			        	window.alert("Success!")
			        	outputJSON = JSON.parse(xmlhttp.responseText);
			        }
			    };
			        xmlhttp.open("GET", url , true);
			        xmlhttp.setRequestHeader( 'Access-Control-Allow-Origin', 'https://albincorreya.github.io');
			        xmlhttp.send();
						}
			}
			*/
			
		</script>

  <body>
    <div id="dropdown" style="margin: 4px">
      <h1>Simplebrainz Browser</h1>
      <form class="form-inline">
        <label>SPARQL:</label>
        <div class="input-append">
          <!--<input id="endpoint" <col>ass="span5" value="" type="text">-->
		<textarea id="sparql" class="span9" rows=4>
SELECT * WHERE{ ?a ?b ?c} LIMIT 100
		</textarea>
		<button class="btn" type="button" onclick="toggle()"><i id="button" class="icon-chevron-up"></i></button>
		<label>MBID:</label>
		<textarea id="mbid" class="span9" rows=1>
		</textarea>
		<button class="btn dropdown-toggle" id="menu1" type="button" data-toggle="dropdown">Entity
		<span class="caret"></span></button>
			<ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Artist</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Release</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Song</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Label</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Area</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Role</a></li>    
			</ul>
        <button class="btn btn-primary" type="button" onclick="onclickSearch()">Query</button>
        <!--<button class="btn" type="button" onclick="sampleGraph()">Get Graph</button>--> 
        </div>
      </form>
    </div>
    <div id="result"></div>
  </body>
</html>
